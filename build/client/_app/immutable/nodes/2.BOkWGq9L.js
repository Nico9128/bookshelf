import"../chunks/DsnmJJEf.js";import{i as fe}from"../chunks/DXwPvkA4.js";import{h as st,a as ft,e as _t,u as x,r as it,p as ce,b2 as mt,b3 as ht,I as De,t as bt,b4 as xt,x as J,ah as te,y as O,X as ye,A as w,B as K,ao as Pe,a1 as Q,ap as Fe,D as u,G as n,F as i,z as W,H as re,o as t,Y as ae,C as N,b5 as me,aq as V,ar as yt,a9 as dt,aj as nt,aS as kt,b6 as Mt,ag as $t}from"../chunks/BndMDAK_.js";import{s as ke,r as Me,p as X,b as ue,a as ve,i as j}from"../chunks/Ce27Asz6.js";import{I as $e,s as we,a as C,m as F,b as Te,e as ie,i as ne,r as ge,c as wt,d as Ce,f as St}from"../chunks/CJ1jM5qb.js";import{i as xe,a as Ct,b as Tt,c as At}from"../chunks/Cj8uB2Pz.js";import{o as Rt}from"../chunks/DcjABtqV.js";import{b as Ee}from"../chunks/v2Yl0rQ2.js";function Bt(o,l,e,h,p){st&&ft();var r=l.$$slots?.[e],a=!1;r===!0&&(r=l[e],a=!0),r===void 0||r(o,a?()=>h:h)}function Dt(o,l,e){_t(()=>{var h=x(()=>l(o,e?.())||{});if(e&&h?.update){var p=!1,r={};it(()=>{var a=e();ce(a),p&&mt(r,a)&&(r=a,h.update(a))}),p=!0}if(h?.destroy)return()=>h.destroy()})}function Ue(o,l,e=l){var h=new WeakSet;ht(o,"input",async p=>{var r=p?o.defaultValue:o.value;if(r=We(o)?qe(r):r,e(r),De!==null&&h.add(De),await bt(),r!==(r=l())){var a=o.selectionStart,d=o.selectionEnd,f=o.value.length;if(o.value=r??"",d!==null){var b=o.value.length;a===d&&d===f&&b>f?(o.selectionStart=b,o.selectionEnd=b):(o.selectionStart=a,o.selectionEnd=Math.min(d,b))}}}),(st&&o.defaultValue!==o.value||x(l)==null&&o.value)&&(e(We(o)?qe(o.value):o.value),De!==null&&h.add(De)),it(()=>{var p=l();if(o===document.activeElement){var r=xt??De;if(h.has(r))return}We(o)&&p===qe(o.value)||o.type==="date"&&!p&&!o.value||p!==o.value&&(o.value=p??"")})}function We(o){var l=o.type;return l==="number"||l==="range"}function qe(o){return o===""?null:+o}function ct(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m12 8-4 4 4 4"}],["path",{d:"M16 12H8"}]];$e(o,ke({name:"circle-arrow-left"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function ut(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 12h8"}],["path",{d:"M12 8v8"}]];$e(o,ke({name:"circle-plus"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function Je(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}],["path",{d:"M3 9h18"}],["path",{d:"M3 15h18"}],["path",{d:"M9 3v18"}],["path",{d:"M15 3v18"}]];$e(o,ke({name:"grid-3x3"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function Et(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]];$e(o,ke({name:"plus"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function Ke(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}],["path",{d:"M21 9H3"}],["path",{d:"M21 15H3"}]];$e(o,ke({name:"rows-3"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function Pt(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];$e(o,ke({name:"trash"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}function Gt(o,l){J(l,!0);let e=Me(l,["$$slots","$$events","$$legacy"]);const h=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];$e(o,ke({name:"x"},()=>e,{get iconNode(){return h},children:(p,r)=>{var a=te(),d=O(a);we(d,()=>l.children??ye),w(p,a)},$$slots:{default:!0}})),K()}const Lt=!1,Ca=Object.freeze(Object.defineProperty({__proto__:null,prerender:Lt},Symbol.toStringTag,{value:"Module"}));var Ut=N('<div><div class="mb-2 flex items-center justify-between"><p>Yearly Reading Progress</p> <p> </p></div> <div class="h-4 w-full overflow-clip rounded-full bg-gray-300"><div style="width: 20%;"></div></div></div>');function Ft(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve(),r=ae();X(l,"progress",8,8);let d=X(l,"data",8)().result.filter(A=>{let G=A.end_date?.slice(0,4);return A.list==="Read"&&G===new Date().getFullYear().toString()}).length;Pe(()=>e(),()=>{Q(r,e().accent)}),Fe(),fe();var f=Ut();let b;var T=u(f),D=n(u(T),2),B=u(D);i(D),i(T);var k=n(T,2),y=u(k);let M;i(k),i(f),W(()=>{b=C(f,1,"rounded-4xl p-4 px-8",null,b,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),re(B,`${d/25*100}% (${d??""}/25)`),M=C(y,1,"h-4",null,M,{"bg-green-400":t(r)==="green","bg-blue-400":t(r)==="blue","bg-red-400":t(r)==="red","bg-orange-400":t(r)==="orange","bg-purple-400":t(r)==="purple"})}),w(o,f),K(),p()}var Nt=N("<button><!> </button>");function Ae(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"text",8,"Button"),a=X(l,"hasIcon",8,!1),d=ae(),f=X(l,"color",8,"");Pe(()=>e(),()=>{Q(d,e().accent)}),Fe(),fe();var b=Nt();let T;var D=u(b);{var B=y=>{var M=te(),A=O(M);Bt(A,l,"icon",{}),w(y,M)};j(D,y=>{a()&&y(B)})}var k=n(D);i(b),W(()=>{T=C(b,1,`flex cursor-pointer items-center gap-2 rounded-full px-4 py-2 text-black ${(f()!=""?f():"")??""}`,null,T,{"bg-blue-300":t(d)==="blue"&&f()=="","bg-green-300":t(d)==="green"&&f()=="","bg-red-300":t(d)==="red"&&f()=="","bg-orange-300":t(d)==="orange"&&f()=="","hover:bg-blue-400":t(d)==="blue"&&f()=="","hover:bg-green-400":t(d)==="green"&&f()=="","hover:bg-red-400":t(d)==="red"&&f()=="","hover:bg-orange-400":t(d)==="orange"&&f()=="","hover:bg-purple-400":t(d)==="purple"&&f()=="","bg-purple-300":t(d)==="purple"&&f()=="","bg-neutral-300":t(d)==="neutral"&&f()=="","hover:bg-neutral-400":t(d)==="neutral"&&f()==""}),re(k,` ${r()??""}`)}),w(o,b),K(),p()}var zt=N('<img id="book-cover" alt="Book Cover"/>'),It=N("<div></div>"),Ot=N('<div class="w-max min-w-max"><p class="mt-1 text-sm"> </p></div>'),jt=N('<div class="flex w-fit cursor-pointer items-center gap-2 rounded-full px-4 py-2">Add Edition <!></div>'),Ht=N('<div><div class="relative"><!></div> <div class="grow"><div><div class="grow"><p class="text-xl"> </p> <p class="text-md italic"> </p></div></div> <div><div class="h-4 w-full overflow-clip rounded-full bg-gray-300"><div style="width: 20%;"></div></div> <!></div> <!></div></div>');function Ge(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve(),r=ae();let a=X(l,"progress",8,null),d=X(l,"title",8,""),f=X(l,"author",8,""),b=X(l,"cover",8,""),T=X(l,"id",8,""),D=X(l,"layout_grid",8,void 0),B=ae(),k=ae(),y=ae(),M=ae(),A=ae(),G=X(l,"suggestion",8,!1),H=X(l,"addSearch",8,!1),L=X(l,"noClick",8,!1);async function Y(){const E=new FormData;E.append("title",d()),E.append("author",f()),E.append("coverUrl",b()),E.append("list",e().default_list),console.log("list:",e().accent),fetch("/?/addBook",{method:"POST",body:E}),await xe()}Rt(()=>{if(!b().includes("http"))return;const E=new ColorThief,I=new Image;I.crossOrigin="Anonymous",I.src=b(),I.onload=()=>{const R=E.getPalette(I,6);try{me(y,t(y).style.backgroundColor=`rgb(${R[0][0]}, ${R[0][1]}, ${R[0][2]})`),me(y,t(y).style.color=`rgb(${R[1][0]}, ${R[1][1]}, ${R[1][2]})`),t(k)&&(me(k,t(k).style.backgroundColor=`rgb(${R[1][0]}, ${R[1][1]}, ${R[1][2]})`),me(k,t(k).style.color=`rgb(${R[0][0]}, ${R[0][1]}, ${R[0][2]})`)),a()===null||a()===100||(me(A,t(A).style.backgroundColor=`rgb(${R[1][0]}, ${R[1][1]}, ${R[1][2]})`),me(M,t(M).style.backgroundColor=`rgb(${R[2][0]}, ${R[2][1]}, ${R[2][2]})`),me(A,t(A).style.backgroundColor=`rgb(${R[1][0]}, ${R[1][1]}, ${R[1][2]})`)),me(y,t(y).style.color=`rgb(${R[1][0]}, ${R[1][1]}, ${R[1][2]})`)}catch(pe){console.error("Error applying colors:",pe)}}}),Pe(()=>e(),()=>{Q(B,e().accent)}),Pe(()=>(ce(D()),e()),()=>{Q(r,D()??e().layout_grid)}),Fe(),fe();var U=Ht();let g;var v=u(U),_=u(v);{var $=E=>{var I=zt();let R;W(()=>{Te(I,"src",`${b()}`),R=C(I,1,"min-w-24 rounded-2xl",null,R,{"md:max-h-64":t(r)||G(),"md:max-w-full":t(r)||G(),"max-w-24":!(t(r)||G())})}),w(E,I)},s=E=>{var I=It();let R;W(()=>R=C(I,1,"aspect-2/3 min-w-24 rounded-2xl",null,R,{"bg-gray-300":!e().darkMode,"bg-neutral-600":e().darkMode,"md:min-h-64":t(r)||G(),"md:w-full":t(r)||G()})),w(E,I)};j(_,E=>{ce(b()),x(()=>b().includes("http"))?E($):E(s,!1)})}i(v);var c=n(v,2),S=u(c);let m;var P=u(S),z=u(P),le=u(z,!0);i(z);var oe=n(z,2),se=u(oe,!0);i(oe),i(P),i(S);var Z=n(S,2);let de;var ee=u(Z),q=u(ee);let he;Ee(q,E=>Q(A,E),()=>t(A)),i(ee),Ee(ee,E=>Q(M,E),()=>t(M));var be=n(ee,2);{var Re=E=>{var I=Ot(),R=u(I),pe=u(R);i(R),i(I),W(()=>re(pe,`${a()??""}% completed`)),w(E,I)};j(be,E=>{a()!==null&&a()!==100&&E(Re)})}i(Z);var Be=n(Z,2);{var Le=E=>{var I=jt(),R=n(u(I));ut(R,{size:16}),i(I),Ee(I,pe=>Q(k,pe),()=>t(k)),V("click",I,()=>{Y()}),w(E,I)};j(Be,E=>{H()&&E(Le)})}i(c),i(U),Ee(U,E=>Q(y,E),()=>t(y)),W(()=>{g=C(U,1,"text-md flex cursor-pointer items-center gap-4 rounded-4xl p-4",null,g,{"bg-neutral-700":e().darkMode,"text-white":e().darkMode,"bg-gray-200":!e().darkMode,"md:flex-col":t(r)||G(),"md:items-start":t(r)||G()}),m=C(S,1,"flex items-start",null,m,{"flex-col":t(r)||G()}),re(le,d()),re(se,f()),de=C(Z,1,"flex items-center gap-4 rounded-full py-2",null,de,{"flex-col":t(r)||G()}),he=C(q,1,"h-4",null,he,{"bg-green-400":t(B)==="green","bg-blue-400":t(B)==="blue","bg-red-400":t(B)==="red","bg-orange-400":t(B)==="orange","bg-purple-400":t(B)==="purple"})}),V("click",U,()=>{G()||H()||L()||F.update(E=>(E.editMode=!0,E.current_book=T(),E))}),w(o,U),K(),p()}var Vt=N('<div><h1>Add Book</h1>   <div class="grid grid-cols-2"><input type="text" name="title" placeholder="Title"/> <input type="text" name="author" placeholder="Author"/>  <a class="m-2"><!></a>  <p>First 5 results shown.</p></div> <div class="grid grid-cols-1 gap-4"></div></div>'),Yt=N('<h1 class="text-4xl">Bookshelf</h1> <p class="mb-4">Welcome back, Nico</p>  <span><!></span> <!> <div class="my-4"><!></div> <div><div class="my-4 flex items-center"><h1 class="grow text-2xl">Currently Reading</h1>  <p class="hidden cursor-pointer md:block"><!></p></div> <div></div></div>',1);function Wt(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"data",8),a=ae(""),d=ae(""),f=ae([]);function b(){console.log("Searching for book:",t(a),t(d));let s="https://openlibrary.org/search.json?";t(a).trim()!==""?s+="title="+t(a).replace(/ /g,"+"):t(d).trim()!==""?s+="author="+t(d).replace(/ /g,"+"):s+="title="+t(a).replace(/ /g,"+")+"&author="+t(d).replace(/ /g,"+"),console.log(s),fetch(s).then(c=>{if(!c.ok)throw new Error("Network response was not ok");return c.json()}).then(c=>{Q(f,c.docs||[]),console.log("Search results:",t(f))}).catch(c=>{console.error("Error:",c)})}fe();var T=Yt(),D=n(O(T),4),B=u(D);Ae(B,{text:"Add Book",hasIcon:!0,$$slots:{icon:(s,c)=>{ut(s,{slot:"icon",size:24})}}}),i(D);var k=n(D,2);{var y=s=>{var c=Vt();let S;var m=n(u(c),2),P=u(m);ge(P);let z;var le=n(P,2);ge(le);let oe;var se=n(le,2),Z=u(se);Ae(Z,{text:"Search"}),i(se),yt(2),i(m);var de=n(m,2);ie(de,5,()=>(t(f),x(()=>t(f).slice(0,5))),ne,(ee,q)=>{{let he=dt(()=>(t(q),x(()=>t(q).author_name?t(q).author_name[0]:"Unknown Author"))),be=dt(()=>(t(q),x(()=>t(q).cover_i?"https://covers.openlibrary.org/b/id/"+t(q).cover_i+"-M.jpg":"")));Ge(ee,{get title(){return t(q),x(()=>t(q).title)},get author(){return t(he)},get cover(){return t(be)},get id(){return t(q),x(()=>t(q).key)},layout_grid:!1,addSearch:!0})}}),i(de),i(c),W(()=>{S=C(c,1,"my-4 rounded-3xl p-4",null,S,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),z=C(P,1,"m-2 rounded-3xl p-2",null,z,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),oe=C(le,1,"m-2 rounded-3xl p-2",null,oe,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode})}),Ue(P,()=>t(a),ee=>Q(a,ee)),Ue(le,()=>t(d),ee=>Q(d,ee)),V("click",se,()=>{b()}),w(s,c)};j(k,s=>{e(),x(()=>e().addingBook)&&s(y)})}var M=n(k,2),A=u(M);Ft(A,{progress:8,get data(){return r()}}),i(M);var G=n(M,2);let H;var L=u(G),Y=n(u(L),2),U=u(Y);{var g=s=>{Ke(s,{size:24})},v=s=>{Je(s,{size:24})};j(U,s=>{e(),x(()=>e().layout_grid)?s(g):s(v,!1)})}i(Y),i(L);var _=n(L,2);let $;ie(_,5,()=>(ce(r()),x(()=>r().result)),ne,(s,c)=>{var S=te(),m=O(S);{var P=z=>{Ge(z,{get title(){return t(c),x(()=>t(c).title)},get author(){return t(c),x(()=>t(c).author)},get cover(){return t(c),x(()=>t(c).coverUrl)},get progress(){return t(c),x(()=>t(c).progress)},get id(){return t(c),x(()=>t(c).id)},get layout_grid(){return e(),x(()=>e().layout_grid)}})};j(m,z=>{t(c),x(()=>t(c).list=="Currently Reading")&&z(P)})}w(s,S)}),i(_),i(G),W(()=>{H=C(G,1,"mb-4 rounded-4xl p-4",null,H,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),$=C(_,1,"grid grid-cols-1 gap-4",null,$,{"md:grid-cols-1":!e().layout_grid,"md:grid-cols-3":e().layout_grid})}),V("click",D,()=>{F.update(s=>(s.addingBook=!s.addingBook,s))}),V("click",Y,()=>{F.update(s=>(s.layout_grid=!s.layout_grid,s))}),w(o,T),K(),p()}var qt=N('<h1 class="text-4xl mb-4">Statistics</h1> <span class="text-xl gap-4 grid grid-cols-2"><p> </p> <p> </p> <p> </p> <p> </p></span>',1);function Xt(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"data",8);function a(){const $=new Date,s=new Date($.getFullYear(),0,1),c=new Date($.getFullYear()+1,0,1),S=$-s,m=c-s;return S/m*100}let d=r().result.filter($=>{let s=$.end_date?.slice(0,4);return $.list==="Read"&&s===new Date().getFullYear().toString()}).length,f=d/(new Date().getMonth()+1),b=ae(Math.round(f*12)),T=a();Q(b,1/(parseFloat(T)/100)*d),fe();var D=qt(),B=n(O(D),2),k=u(B);let y;var M=u(k);i(k);var A=n(k,2);let G;var H=u(A);i(A);var L=n(A,2);let Y;var U=u(L);i(L);var g=n(L,2);let v;var _=u(g);i(g),i(B),W(($,s)=>{y=C(k,1,"p-4 rounded-4xl",null,y,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode}),re(M,`${ce(r()),x(()=>r().result.length)??""} books loaded.`),G=C(A,1,"p-4 rounded-4xl",null,G,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode}),re(H,`You have finished ${$??""} books.`),Y=C(L,1,"p-4 rounded-4xl",null,Y,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode}),re(U,`You have finished ${d??""} books this year`),v=C(g,1,"p-4 rounded-4xl",null,v,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode}),re(_,`At this pace, you will finish ${s??""} books this year in total,`)},[()=>(ce(r()),x(()=>r().result.filter($=>$.list==="Read").length)),()=>(t(b),x(()=>Math.round(t(b))))]),w(o,D),K(),p()}var Jt=N('<img alt="Book Cover" class="ml-4 h-24 rounded-2xl"/>'),Kt=N('<img alt="Book Cover" class="ml-4 h-24 rounded-2xl"/>'),Qt=N('<img alt="Book Cover" class="ml-4 h-24 rounded-2xl"/>'),Zt=N('<img alt="Book Cover" class="h-24 rounded-2xl"/>'),ea=N("<div> </div>"),ta=N('<h1 class="mb-4 text-4xl">Books</h1>   <div class="grid grid-cols-1 gap-4"><div><p class="grow text-xl">Currently Reading</p> <div class="flex"></div></div> <div><p class="grow text-xl">TBR</p> <div class="flex"></div></div> <div><p class="grow text-xl">Finished</p> <div class="flex"></div></div> <div><p class="mb-4 grow text-xl">All Books</p> <div class="flex flex-wrap gap-4"></div></div></div> <p class="my-2 text-xl">Tags</p> <div class="flex flex-wrap gap-2"></div>',1);function aa(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"data",8),a=[];r().result.forEach(g=>{g.tags&&g.tags.split(",").forEach(v=>{!a.includes(v.trim())&&v.trim()!==""&&a.push(v.trim())})}),fe();var d=ta(),f=n(O(d),2),b=u(f);let T;var D=n(u(b),2);ie(D,5,()=>(ce(r()),x(()=>r().result.filter(g=>g.coverUrl.includes("http")&&g.list==="Currently Reading"))),ne,(g,v,_)=>{var $=te(),s=O($);{var c=S=>{var m=Jt();W(()=>Te(m,"src",(t(v),x(()=>t(v).coverUrl)))),w(S,m)};j(s,S=>{_<3&&S(c)})}w(g,$)}),i(D),i(b);var B=n(b,2);let k;var y=n(u(B),2);ie(y,5,()=>(ce(r()),x(()=>r().result.filter(g=>g.coverUrl.includes("http")&&g.list==="Want to Read"))),ne,(g,v,_)=>{var $=te(),s=O($);{var c=S=>{var m=Kt();W(()=>Te(m,"src",(t(v),x(()=>t(v).coverUrl)))),w(S,m)};j(s,S=>{_<3&&S(c)})}w(g,$)}),i(y),i(B);var M=n(B,2);let A;var G=n(u(M),2);ie(G,5,()=>(ce(r()),x(()=>r().result.filter(g=>g.coverUrl.includes("http")&&g.list==="Read"))),ne,(g,v,_)=>{var $=te(),s=O($);{var c=S=>{var m=Qt();W(()=>Te(m,"src",(t(v),x(()=>t(v).coverUrl)))),w(S,m)};j(s,S=>{_<3&&S(c)})}w(g,$)}),i(G),i(M);var H=n(M,2);let L;var Y=n(u(H),2);ie(Y,5,()=>(ce(r()),x(()=>r().result.filter(g=>g.coverUrl.includes("http")))),ne,(g,v,_)=>{var $=te(),s=O($);{var c=S=>{var m=Zt();W(()=>Te(m,"src",(t(v),x(()=>t(v).coverUrl)))),w(S,m)};j(s,S=>{_<8&&S(c)})}w(g,$)}),i(Y),i(H),i(f);var U=n(f,4);ie(U,5,()=>a,ne,(g,v)=>{var _=ea();let $;var s=u(_,!0);i(_),W(()=>{$=C(_,1,"flex cursor-pointer items-center gap-1 rounded-3xl p-2",null,$,{"bg-gray-300":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode,"hover:bg-neutral-600":e().darkMode,"hover:bg-gray-400":!e().darkMode}),re(s,t(v))}),V("click",_,()=>{F.update(c=>(c.listView=!0,c.current_list="tag:"+t(v),c))}),w(g,_)}),i(U),W(()=>{T=C(b,1,"flex cursor-pointer items-center rounded-3xl p-4",null,T,{"bg-gray-100":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode,"hover:bg-neutral-700":e().darkMode,"hover:bg-gray-200":!e().darkMode}),k=C(B,1,"flex cursor-pointer items-center rounded-3xl p-4",null,k,{"bg-gray-100":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode,"hover:bg-neutral-700":e().darkMode,"hover:bg-gray-200":!e().darkMode}),A=C(M,1,"flex cursor-pointer items-center rounded-3xl p-4",null,A,{"bg-gray-100":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode,"hover:bg-neutral-700":e().darkMode,"hover:bg-gray-200":!e().darkMode}),L=C(H,1,"cursor-pointer items-center rounded-3xl p-4",null,L,{"bg-gray-100":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-800":e().darkMode,"hover:bg-neutral-700":e().darkMode,"hover:bg-gray-200":!e().darkMode})}),V("click",b,()=>{F.update(g=>(g.listView=!0,g.current_list="Currently Reading",g))}),V("click",B,()=>{F.update(g=>(g.listView=!0,g.current_list="Want to Read",g))}),V("click",M,()=>{F.update(g=>(g.listView=!0,g.current_list="Read",g))}),V("click",H,()=>{F.update(g=>(g.listView=!0,g.current_list="All",g))}),w(o,d),K(),p()}var ra=N('<h1 class="text-4xl">Settings</h1> <p>Pick Accent:</p> <div class="grid w-64 grid-cols-6"><div class="h-8 cursor-pointer rounded-l-full bg-red-500"></div> <div class="h-8 cursor-pointer bg-orange-500"></div> <div class="h-8 cursor-pointer bg-green-500"></div> <div class="h-8 cursor-pointer bg-blue-500"></div> <div class="h-8 cursor-pointer bg-purple-500"></div> <div class="h-8 cursor-pointer rounded-r-full bg-neutral-500"></div></div>',1);function la(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=ae();function a(M){F.update(A=>(A.accent=M,A))}Pe(()=>e(),()=>{Q(r,e().accent)}),Fe(),fe();var d=ra(),f=n(O(d),4),b=u(f),T=n(b,2),D=n(T,2),B=n(D,2),k=n(B,2),y=n(k,2);i(f),V("click",b,()=>{a("red")}),V("click",T,()=>{a("orange")}),V("click",D,()=>{a("green")}),V("click",B,()=>{a("blue")}),V("click",k,()=>{a("purple")}),V("click",y,()=>{a("neutral")}),w(o,d),K(),p()}function oa(o){const l=JSON.parse(o);return l.data&&(l.data=Tt(l.data,At.decoders)),l}function Xe(o){return HTMLElement.prototype.cloneNode.call(o)}function da(o,l=()=>{}){const e=async({action:p,result:r,reset:a=!0,invalidateAll:d=!0})=>{r.type==="success"&&(a&&HTMLFormElement.prototype.reset.call(o),d&&await xe()),(location.origin+location.pathname===p.origin+p.pathname||r.type==="redirect"||r.type==="error")&&await Ct(r)};async function h(p){if((p.submitter?.hasAttribute("formmethod")?p.submitter.formMethod:Xe(o).method)!=="post")return;p.preventDefault();const a=new URL(p.submitter?.hasAttribute("formaction")?p.submitter.formAction:Xe(o).action),d=p.submitter?.hasAttribute("formenctype")?p.submitter.formEnctype:Xe(o).enctype,f=new FormData(o,p.submitter),b=new AbortController;let T=!1;const B=await l({action:a,cancel:()=>T=!0,controller:b,formData:f,formElement:o,submitter:p.submitter})??e;if(T)return;let k;try{const y=new Headers({accept:"application/json","x-sveltekit-action":"true"});d!=="multipart/form-data"&&y.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(d)?d:"application/x-www-form-urlencoded");const M=d==="multipart/form-data"?f:new URLSearchParams(f),A=await fetch(a,{method:"POST",headers:y,cache:"no-store",body:M,signal:b.signal});k=oa(await A.text()),k.type==="error"&&(k.status=A.status)}catch(y){if(y?.name==="AbortError")return;k={type:"error",error:y}}await B({action:a,formData:f,formElement:o,update:y=>e({action:a,result:k,reset:y?.reset,invalidateAll:y?.invalidateAll}),result:k})}return HTMLFormElement.prototype.addEventListener.call(o,"submit",h),{destroy(){HTMLFormElement.prototype.removeEventListener.call(o,"submit",h)}}}var sa=N('<div><!></div> <form method="POST" action="/?/updateBook"><div class="flex items-stretch gap-4"><div class="grid grow grid-cols-1"><input type="text" name="title" placeholder="Title"/> <input type="text" name="author" placeholder="Author"/> <div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="coverUrl" class="mx-2 mt-2">Cover URL</label> <input type="text" name="coverUrl" placeholder="Cover URL"/></div> <div class="flex flex-col"><label for="isbn" class="mx-2 mt-2">ISBN</label> <input type="text" name="isbn" placeholder="ISBN"/></div></div> <div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="start_date" class="mx-2 mt-2">Start Date</label> <input type="date" name="start_date" placeholder="Start Date"/></div> <div class="flex flex-col"><label for="end_date" class="mx-2 mt-2">End Date</label> <input type="date" name="end_date" placeholder="End Date"/></div></div> <select name="list"><option disabled selected>Select List</option><option>Currently Reading</option><option>Want to Read</option><option>Read</option></select> <div class="flex gap-4"><span class="my-2 flex"><!></span> <button type="button" class="my-2 flex" aria-label="delete"><!></button></div></div> <img alt="Book Cover" class="aspect-[2/3] h-full max-h-92 rounded-2xl object-cover"/></div></form>',1),ia=N("<div> <!></div>"),na=N('<!> <label for="tags" class="mx-2 mt-2">Tags</label> <div class="flex flex-col flex-wrap gap-2"><div class="flex gap-2 flex-wrap"><div><input type="text" name="tags" size="8" placeholder="Type here"/> <a class="cursor-pointer"><!></a></div> <!></div></div> <h1 class="mb-4 text-2xl">Recommendations</h1> <a><!></a> <div class="grid grid-cols-3 gap-4"></div>',1);function ca(o,l){J(l,!0);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=e().current_book;console.log(l.data);let a=nt(()=>l.data.result?.filter(m=>m.id===r)[0]),d="",f,b=[];const T=({formData:m,cancel:P})=>(m.append("id",r),async({result:z})=>{z.type==="success"&&(await xe(),console.log("Book updated successfully"))});async function D(m){const P=new FormData;P.append("id",r),t(a).tags=t(a).tags?t(a).tags+","+d:d,P.append("tags",t(a).tags),await fetch("/?/addTag",{method:"POST",body:P}),d="",f.value="",await xe()}function B(m){const P=new FormData;P.append("id",r),t(a).tags=t(a).tags.split(",").filter(z=>z!==m).join(","),P.append("tags",t(a).tags),d="",fetch("/?/addTag",{method:"POST",body:P}),xe()}async function k(){const m=new FormData;m.append("id",r),fetch("/?/deleteBook",{method:"POST",body:m}),await xe()}var y=na(),M=O(y);{var A=m=>{var P=sa(),z=O(P),le=u(z);ct(le,{size:32,class:"cursor-pointer"}),i(z);var oe=n(z,2),se=u(oe),Z=u(se),de=u(Z);ge(de);let ee;var q=n(de,2);ge(q);let he;var be=n(q,2),Re=u(be),Be=n(u(Re),2);ge(Be);let Le;i(Re);var E=n(Re,2),I=n(u(E),2);ge(I);let R;i(E),i(be);var pe=n(be,2),Ne=u(pe),ze=n(u(Ne),2);ge(ze);let Qe;i(Ne);var Ze=n(Ne,2),Ie=n(u(Ze),2);ge(Ie);let et;i(Ze),i(pe);var _e=n(pe,2);let tt;var Oe=u(_e);Oe.value=Oe.__value="";var je=n(Oe);je.value=je.__value="Currently Reading";var He=n(je);He.value=He.__value="Want to Read";var at=n(He);at.value=at.__value="Read",i(_e);var rt;wt(_e);var lt=n(_e,2),Ve=u(lt),vt=u(Ve);Ae(vt,{text:"Update"}),i(Ve);var Ye=n(Ve,2),gt=u(Ye);Ae(gt,{hasIcon:!0,text:"Delete",$$slots:{icon:(Se,ot)=>{Pt(Se,{slot:"icon",size:16})}}}),i(Ye),i(lt),i(Z);var pt=n(Z,2);i(se),i(oe),Dt(oe,(Se,ot)=>da?.(Se,ot),()=>T),W(()=>{Ce(de,t(a).title),ee=C(de,1,"my-2 rounded-3xl p-2 text-3xl",null,ee,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),Ce(q,t(a).author),he=C(q,1,"my-2 rounded-3xl p-2",null,he,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),Ce(Be,t(a).coverUrl),Le=C(Be,1,"my-2 rounded-3xl p-2",null,Le,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),Ce(I,t(a).isbn),R=C(I,1,"my-2 rounded-3xl p-2",null,R,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),Ce(ze,t(a).start_date),Qe=C(ze,1,"my-2 rounded-3xl p-2",null,Qe,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),Ce(Ie,t(a).end_date),et=C(Ie,1,"my-2 rounded-3xl p-2",null,et,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),tt=C(_e,1,"my-2 rounded-3xl p-2",null,tt,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),rt!==(rt=t(a).list)&&(_e.value=(_e.__value=t(a).list)??"",St(_e,t(a).list)),Te(pt,"src",t(a).coverUrl)}),V("click",z,()=>{F.update(Se=>(Se.editMode=!1,console.log("FALSLLELE"),Se))}),V("click",Ye,()=>k()),w(m,P)};j(M,m=>{t(a)&&m(A)})}var G=n(M,4),H=u(G),L=u(H);let Y;var U=u(L);ge(U);let g;Ee(U,m=>f=m,()=>f);var v=n(U,2),_=u(v);Et(_,{size:16}),i(v),i(L);var $=n(L,2);ie($,17,()=>(t(a)?.tags||"").split(","),ne,(m,P)=>{var z=te(),le=O(z);{var oe=se=>{var Z=ia();let de;var ee=u(Z),q=n(ee);Gt(q,{size:16}),i(Z),W(()=>{de=C(Z,1,"flex cursor-pointer items-center gap-1 rounded-3xl p-2",null,de,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),re(ee,`${t(P)??""} `)}),V("click",Z,()=>{B(t(P))}),w(se,Z)};j(le,se=>{t(P)!==""&&se(oe)})}w(m,z)}),i(H),i(G);var s=n(G,4),c=u(s);Ae(c,{text:"Reccomend Similar Books",color:"bg-amber-500"}),i(s);var S=n(s,2);ie(S,21,()=>b,ne,(m,P,z,le)=>{Ge(m,{get title(){return t(P).title},get cover(){return t(P).image},suggestion:!0})}),i(S),W(()=>{Y=C(L,1,"flex w-min items-center gap-1 rounded-3xl p-2",null,Y,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),g=C(U,1,"w-min bg-transparent outline-none",null,g,{"text-black":!e().darkMode,"text-white":e().darkMode})}),Ue(U,()=>d,m=>d=m),V("click",v,()=>{D()}),V("click",s,()=>{getRecommendations()}),w(o,y),K(),p()}var ua=N("<div><!></div>"),va=N('<div><h1 class="text-2xl"> </h1> <p> </p> <div><!></div></div>'),ga=N('<h1 class="text-4xl mb-4">Timer</h1> <div><div class="my-4 flex items-center"><h1 class="grow text-2xl">Choose book TO TIME</h1>  <p class="hidden cursor-pointer md:block"><!></p></div> <div></div></div> <!>',1);function pa(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"data",8);xe();let a=ae(),d=ae(0);function f(v){F.update(_=>(_.isbook=!0,_)),Q(d,r().result.filter(_=>_.id===v.id)[0].reading_time||0),Q(a,v),Q(d,parseInt(t(a).reading_time)||0)}function b(){const v=new FormData;v.append("id",t(a).id),console.log("Current book ID:",t(a)),v.append("reading_time",t(d)),console.log("Saving reading time:",t(d),"for book:",t(a)),fetch("/?/updateReadingTime",{method:"POST",body:v})}function T(){console.log("Starting timer for:",t(a)),setInterval(()=>{Mt(d),t(d)%10===0&&b()},1e3)}fe();var D=ga(),B=n(O(D),2);let k;var y=u(B),M=n(u(y),2);M.__click=()=>{F.update(v=>(v.layout_grid=!v.layout_grid,v))};var A=u(M);{var G=v=>{Ke(v,{size:24})},H=v=>{Je(v,{size:24})};j(A,v=>{e(),x(()=>e().layout_grid)?v(G):v(H,!1)})}i(M),i(y);var L=n(y,2);let Y;ie(L,5,()=>(ce(r()),x(()=>r().result)),ne,(v,_)=>{var $=te(),s=O($);{var c=S=>{var m=ua();m.__click=()=>{f(t(_))};var P=u(m);Ge(P,{get title(){return t(_),x(()=>t(_).title)},get author(){return t(_),x(()=>t(_).author)},get cover(){return t(_),x(()=>t(_).coverUrl)},get progress(){return t(_),x(()=>t(_).progress)},get id(){return t(_),x(()=>t(_).id)},get layout_grid(){return e(),x(()=>e().layout_grid)},noClick:!0}),i(m),w(S,m)};j(s,S=>{t(_),x(()=>t(_).list=="Currently Reading")&&S(c)})}w(v,$)}),i(L),i(B);var U=n(B,2);{var g=v=>{var _=va();let $;var s=u(_),c=u(s);i(s);var S=n(s,2),m=u(S);i(S);var P=n(S,2);P.__click=()=>T();var z=u(P);Ae(z,{class:"mt-4",text:"Start Timer"}),i(P),i(_),W((le,oe)=>{$=C(_,1,"p-4 rounded-4xl",null,$,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),re(c,`Time ${t(a),x(()=>t(a).title)??""}`),re(m,`${le??""} hours, ${oe??""} minutes, ${t(d)%60} seconds`)},[()=>(t(d),x(()=>Math.floor(t(d)/3600))),()=>(t(d),x(()=>Math.floor(t(d)%3600/60)))]),w(v,_)};j(U,v=>{t(a)!=null&&v(g)})}W(()=>{k=C(B,1,"mb-4 rounded-4xl p-4",null,k,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),Y=C(L,1,"grid grid-cols-1 gap-4",null,Y,{"md:grid-cols-1":!e().layout_grid,"md:grid-cols-3":e().layout_grid})}),w(o,D),K(),p()}kt(["click"]);var fa=N('<div><!></div> <h1 class="my-4 text-4xl"> </h1> <div><div class="my-4 flex items-center"><h1 class="grow text-2xl"> </h1> <p class="hidden cursor-pointer md:block"><!></p></div> <input type="text" placeholder="Search in list..."/> <div></div></div>',1);function _a(o,l){J(l,!0);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=l.data.result,a=$t("");console.log(e().current_list.slice(0,4)=="tag:"&&r[0].tags.split(",").includes(e().current_list.slice(4)));let d=nt(()=>r.filter(s=>(s.list===e().current_list||e().current_list==="All"||e().current_list.slice(0,4)=="tag:"&&s.tags.split(",").includes(e().current_list.slice(4)))&&(s.title.toLowerCase().includes(t(a).toLowerCase())||s.author.toLowerCase().includes(t(a).toLowerCase()))));var f=fa(),b=O(f),T=u(b);ct(T,{size:32,class:"cursor-pointer"}),i(b);var D=n(b,2),B=u(D,!0);i(D);var k=n(D,2);let y;var M=u(k),A=u(M),G=u(A,!0);i(A);var H=n(A,2),L=u(H);{var Y=s=>{Ke(s,{size:24})},U=s=>{Je(s,{size:24})};j(L,s=>{e().layout_grid?s(Y):s(U,!1)})}i(H),i(M);var g=n(M,2);ge(g);let v;var _=n(g,2);let $;ie(_,21,()=>t(d),ne,(s,c)=>{Ge(s,{get title(){return t(c).title},get author(){return t(c).author},get cover(){return t(c).coverUrl},get progress(){return t(c).progress},get id(){return t(c).id},get layout_grid(){return e().layout_grid}})}),i(_),i(k),W(()=>{re(B,e().current_list),y=C(k,1,"mb-4 rounded-4xl p-4",null,y,{"bg-neutral-800":e().darkMode,"text-white":e().darkMode,"bg-gray-100":!e().darkMode}),re(G,e().current_list),v=C(g,1,"mb-4 w-full rounded-3xl p-2 text-black",null,v,{"bg-gray-200":!e().darkMode,"text-black":!e().darkMode,"bg-neutral-700":e().darkMode}),$=C(_,1,"grid grid-cols-1 gap-4",null,$,{"md:grid-cols-1":!e().layout_grid,"md:grid-cols-3":e().layout_grid})}),V("click",b,()=>{F.update(s=>(s.listView=!1,console.log("FALSLLELE"),s))}),V("click",H,()=>{F.update(s=>(s.layout_grid=!s.layout_grid,s))}),Ue(g,()=>t(a),s=>Q(a,s)),w(o,f),K(),p()}var ma=N("<!> <!> <!> <!> <!>",1),ha=N('<div class="p-6 md:px-0 md:pt-16"><!></div>');function Ta(o,l){J(l,!1);const e=()=>ue(F,"$myGlobalState",h),[h,p]=ve();let r=X(l,"data",8);console.log(e().page),e().default_list===""&&F.update(T=>(T.default_list="Want to Read",T)),console.log(r()),console.log("Default list:",e().default_list),fe();var a=ha(),d=u(a);{var f=T=>{ca(T,{get data(){return r()}})},b=T=>{var D=te(),B=O(D);{var k=M=>{_a(M,{get data(){return r()}})},y=M=>{var A=ma(),G=O(A);{var H=c=>{Wt(c,{get data(){return r()}})};j(G,c=>{e(),x(()=>e().page==="home")&&c(H)})}var L=n(G,2);{var Y=c=>{Xt(c,{get data(){return r()}})};j(L,c=>{e(),x(()=>e().page==="stats")&&c(Y)})}var U=n(L,2);{var g=c=>{pa(c,{get data(){return r()}})};j(U,c=>{e(),x(()=>e().page==="timer")&&c(g)})}var v=n(U,2);{var _=c=>{aa(c,{get data(){return r()}})};j(v,c=>{e(),x(()=>e().page==="books")&&c(_)})}var $=n(v,2);{var s=c=>{la(c,{get data(){return r()}})};j($,c=>{e(),x(()=>e().page==="settings")&&c(s)})}w(M,A)};j(B,M=>{e(),x(()=>e().listView===!0)?M(k):M(y,!1)},!0)}w(T,D)};j(d,T=>{e(),x(()=>e().editMode===!0)?T(f):T(b,!1)})}i(a),w(o,a),K(),p()}export{Ta as component,Ca as universal};
